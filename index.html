<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CcpvSong</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="estilos.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
     <link rel="shortcut icon" href="img/Ccpv Songs.png" type="image/x-icon">

</head>
<body>
    <header class="container-fluid">
        <div class="container p-0 nv">
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid p-0" >
                  <a class="navbar-brand logo" onclick="alternarEstilos()"><img src="img/Ccpv Songs.png" alt=""> <p class="center">CcpvSongs</p></a>
                  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                    <span id="icon_menu" class="navbar-toggler-icon"></span>
                  </button>
                  <div class="collapse navbar-collapse" id="navbarNavDropdown">
                    <ul class="navbar-nav">
                      <li class="nav-item">
                        <a class="nav-link active text-light" aria-current="page" onclick="inicio()">Home</a>
                        <a class="nav-link active text-light" aria-current="page" onclick="verlista()">Lista</a>
                        <a class="nav-link active text-light" aria-current="page" onclick="ver()">Ver</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </nav>
        </div>
    </header>



    <main id="cartas" >
        <div class="container  c_a">

            <div class="container botones_opciones">
                
                <div class="btn-group" role="group" aria-label="Basic example">
                    <button type="button" class="btn btn_tipo" onclick="mostrarRapida()">Rapidas</button>
                    <button type="button" class="btn btn_tipo" onclick="mostrarLenta()">Lentas</button>
                    <button type="button" class="btn btn_tipo" onclick="mostrarAmbas()">Todas</button>
                    <button type="button" class="btn btn_tipo" onclick="mostrarCancionesAleatorias()"><i class="fa-solid fa-shuffle"></i></button>
                  </div>

                  <div class="d-flex buscador">
                    <input class="form-control me-2" placeholder="Nombre" aria-label="Search" id="searchInput">
                    <button class="btn btn_buscar" onclick="searchCard()">Buscar</button>
                  </div>
            </div>
            
            <div class="container cartas_container" id="cart_con">
                
                <!-- Cartas de canciones 
                <div class="carta" id="Glorioso">
                    <a href="https://youtu.be/We9t45tn8wA?si=s1BAsJ0Aslke_PIm" class="container_img" target="_blank"> <img src="https://tse3.explicit.bing.net/th?id=OIP.WjrOuFJ6wUzIhOtarEPNUgHaEK&pid=Api&P=0&h=180" alt=""></a>
                    <div class="descripcion">
                        <p class="titulo">Glorioso</p>
                        <p class="intro">¡Glorioso! Te cantamos ¡Glorioso! Lo gritamos ¡Glorioso! ¡Glorioso! ¡Glorioso! ¡Glorioso!</p>
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-outline-secondary" onclick='cargarCanciones("0","N")'>View</button>
                        </div>
                    </div>
                </div>
                
                 Fin de cartas de canciones -->

                

            </div>
        </div>
    </main>

    <div id="cancion" class="container">

        <div class="con_menu" id="can">
            
            <div class="ton">
                <div class="mit1"><span id="tonsug"></span></div>
                <div class="mit2"><iframe id="practicar" src=""  frameborder="0"  referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>
            </div>

            <div class="btn-group tonalidades">
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("N")'>#</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("C")'>C</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("D")'>D</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("E")'>E</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("F")'>F</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("G")'>G</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("A")'>A</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("B")'>B</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='tono("L")'>L</button>
                <button type="button" class="btn btn-sm btn-outline-secondary" onclick='agregarCancion()'><i class="bi bi-star"></i></button>
            </div>


            <p></p>
        </div>
        
    </div>

    <div id="lis" class="lista container">
        <div class="con_menu" id="li">
            <div class="btndescargar" onclick="imprimirPagina()">
                <img src="img/des.png" alt="" class="descar">
            </div>
            <p></p>
        </div>
    </div>

    <footer></footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        function mostrarCancionesAleatorias() {
            // Obtener todas las canciones rápidas y lentas
            const cancionesRapidas = document.querySelectorAll('.carta.Rapida');
            const cancionesLentas = document.querySelectorAll('.carta.Lenta');
        
            // Seleccionar 2 canciones rápidas y 2 lentas al azar
            const cancionesRapidasAleatorias = seleccionarCancionesAleatorias(cancionesRapidas, 2);
            const cancionesLentasAleatorias = seleccionarCancionesAleatorias(cancionesLentas, 2);
        
            // Ocultar todas las canciones
            ocultarTodasLasCanciones();
        
            // Mostrar las canciones seleccionadas
            mostrarCanciones(cancionesRapidasAleatorias);
            mostrarCanciones(cancionesLentasAleatorias);
        }
        
        function seleccionarCancionesAleatorias(canciones, cantidad) {
            const cancionesAleatorias = [];
            const copiaCanciones = Array.from(canciones);
        
            for (let i = 0; i < cantidad; i++) {
                const index = Math.floor(Math.random() * copiaCanciones.length);
                const cancion = copiaCanciones.splice(index, 1)[0];
                cancionesAleatorias.push(cancion);
            }
        
            return cancionesAleatorias;
        }
        
        function ocultarTodasLasCanciones() {
            const canciones = document.querySelectorAll('.carta');
            canciones.forEach(cancion => {
                cancion.style.display = 'none';
            });
        }
        
        function mostrarCanciones(canciones) {
            canciones.forEach(cancion => {
                cancion.style.display = 'block';
            });
        }

         // Agrega un event listener para el evento 'input' del campo de búsqueda
         document.getElementById('searchInput').addEventListener('input', searchCard);

         function searchCard() {
             // Obtiene el valor del input, elimina los espacios y lo pasa a minúsculas para la comparación
             const searchValue = document.getElementById('searchInput').value.replace(/\s+/g, '').toLowerCase();
             
             // Obtiene todas las cartas
             const cards = document.getElementsByClassName('carta');
             
             // Recorre todas las cartas
             for (let card of cards) {
                 // Obtiene el ID de la carta, elimina los espacios y lo pasa a minúsculas
                 const cardId = card.id.replace(/\s+/g, '').toLowerCase();
                 
                 // Verifica si el ID de la carta comienza con el valor del input
                 if (cardId.startsWith(searchValue)) {
                     // Si coincide, muestra la carta
                     card.style.display = 'block';
                 } else {
                     // Si no coincide, oculta la carta
                     card.style.display = 'none';
                 }
             }
         }

        var cancion_anterior;
        var tonalidad_anterior;
        var i=0;
        var ante;

        var cancionesAgregadas = []; // Array para almacenar las canciones agregadas
        var cancionesListaTonalidad = [];
        var cancionesLista = [];
        
        // Función para agregar una canción al array de canciones agregadas
        function agregarCancion() {
            document.getElementById("")
            cancionesAgregadas.push(ante);
            cancionesListaTonalidad.push(tonalidad_anterior);
            console.log(cancionesAgregadas)   
            agregadas(cancionesAgregadas[i], cancionesListaTonalidad[i] , i) 
            i++
        }


        function inicio(){
            document.getElementById("cartas").style.display="block";
            document.getElementById("can").style.display="none";
            document.getElementById("li").style.display="none";
        }

        function ver(){
            document.getElementById("cartas").style.display="none";
            document.getElementById("can").style.display="block";
            document.getElementById("li").style.display="none";
            
        }

        function verlista(){

            document.getElementById("cartas").style.display="none";
            document.getElementById("can").style.display="none";
            document.getElementById("li").style.display="block";

            let cancion = document.getElementById("lis");

           
            cancion.querySelector("p").innerHTML = cancionesLista;

            console.log(cancionesLista)
        }
        

        function tono(tono){
            console.log(tono)
            console.log(cancion_anterior)
            cargarCanciones(cancion_anterior, tono);
        }
     


        // Función para cargar el archivo JSON de canciones
        function cargarCanciones(num, tonalidad) {
            cancion_anterior=num;
            console.log("ante" +ante);tonalidad_anterior=tonalidad;
            fetch('canciones.json') // Ruta al archivo JSON de canciones
                .then(response => response.json()) // Convertir la respuesta a JSON
                .then(data => {
                    // Llamar a la función hola con la primera canción del archivo JSON
                    hola(data.canciones[num].id, tonalidad);
                })
                .catch(error => console.error('Error al cargar el archivo JSON:', error));
        }

  

        // Función para mostrar la letra de la canción
        function hola(id, tonalidad) {
            ver()
            let cancion = document.getElementById("cancion");
            let tonalidades = {
                "C": ["C", "Dm", "Em", "F", "G", "Am", "Bdim"],
                "D": ["D", "Em", "F#m", "G", "A", "Bm", "C#dim"],
                "E": ["E", "F#m", "G#m", "A", "B", "C#m", "D#dim"],
                "F": ["F", "Gm", "Am", "A#", "C", "Dm", "Edim"],
                "G": ["G", "Am", "Bm", "C", "D", "Em", "F#dim"],
                "A": ["A", "Bm", "C#m", "D", "E", "F#m", "G#dim"],
                "B": ["B", "C#m", "D#m", "E", "F#", "G#m", "A#dim"],
                "N": ["1", "2", "3", "4", "5", "6", "7"],
                "L": ["", "", "", "", "", "", ""],
            };

            console.log(id)
            ante=id
            console.log(ante)

            

            fetch('canciones.json') // Ruta al archivo JSON de canciones
                .then(response => response.json()) // Convertir la respuesta a JSON
                .then(data => {

                    let cancionActual = data.canciones.find(cancion => cancion.id === id);
                    let cancionTexto = cancionActual.letra;
                    // Reemplazar los números por las notas según la tonalidad
                    for (let i = 1; i <= tonalidades[tonalidad].length; i++) {
                        let nota = tonalidades[tonalidad][i - 1];
                        let regex = new RegExp("\\(" + i + "\\)", "g");
                        cancionTexto = cancionTexto.replace(regex, "<b>" + nota + "</b>");
                    }

                    

                    // Mostrar la letra de la canción en el div con el id "cancion"
                    cancion.querySelector("p").innerHTML ="<titulo>"+cancionActual.titulo+"</titulo><br>"+cancionTexto;
                    cancion.querySelector("#tonsug").innerHTML=cancionActual.general;
                    console.log(cancionActual.general)
                    cancion.querySelector("#practicar").src=cancionActual.mini;
                    console.log(cancionActual.mini)

                })
                .catch(error => console.error('Error al cargar el archivo JSON:', error));
        }



        function agregadas(id, tonalidad, i) {
            
            let tonalidades = {
                "C": ["C", "Dm", "Em", "F", "G", "Am", "Bdim"],
                "D": ["D", "Em", "F#m", "G", "A", "Bm", "C#dim"],
                "E": ["E", "F#m", "G#m", "A", "B", "C#m", "D#dim"],
                "F": ["F", "Gm", "Am", "Bb", "C", "Dm", "Edim"],
                "G": ["G", "Am", "Bm", "C", "D", "Em", "F#dim"],
                "A": ["A", "Bm", "C#m", "D", "E", "F#m", "G#dim"],
                "B": ["B", "C#m", "D#m", "E", "F#", "G#m", "A#dim"],
                "N": ["1", "2", "3", "4", "5", "6", "7"],
                "L": ["", "", "", "", "", "", ""],
            };


            fetch('canciones.json') // Ruta al archivo JSON de canciones
                .then(response => response.json()) // Convertir la respuesta a JSON
                .then(data => {

                    let cancionActual = data.canciones.find(cancion => cancion.id === id);
                    let cancionTexto = cancionActual.letra;
                    // Reemplazar los números por las notas según la tonalidad
                    for (let i = 1; i <= tonalidades[tonalidad].length; i++) {
                        let nota = tonalidades[tonalidad][i - 1];
                        let regex = new RegExp("\\(" + i + "\\)", "g");
                        cancionTexto = cancionTexto.replace(regex, "<b>" + nota + "</b>");
                    }

                    

                    // Mostrar la letra de la canción en el div con el id "cancion"
                    cancionesLista.push("<hr><titulo>"+ cancionActual.titulo+"</titulo><br>"+cancionTexto);
                    console.log(cancionesLista)

                    
                })
                .catch(error => console.error('Error al cargar el archivo JSON:', error));
        }
        
        

         // Función para cargar el archivo JSON
function cargarJSON(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.overrideMimeType("application/json");
    xhr.open('GET', url, true);
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
            callback(xhr.responseText);
        }
    };
    xhr.send(null);
}
// Función para cargar el archivo JSON
function cargarJSON(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.overrideMimeType("application/json");
    xhr.open('GET', url, true);
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
            callback(xhr.responseText);
        }
    };
    xhr.send(null);
}

// Función para crear las cartas
function crearCartas(canciones) {
    var mainElement = document.getElementById("cart_con");

    canciones.forEach(function(cancion) {
        var cartaElement = document.createElement("div");
        cartaElement.classList.add("carta");
        cartaElement.classList.add(cancion.tipo);
        cartaElement.id = cancion.titulo.replace(/\s/g, '');

        var enlaceElement = document.createElement("a");
        enlaceElement.href = cancion.youtube; // Usar el enlace de YouTube de la canción
        enlaceElement.classList.add("container_img");
        enlaceElement.target = "_blank";

        var imgElement = document.createElement("img");
        imgElement.src = cancion.post; // Usar el enlace de la portada de la canción
        imgElement.alt = "";

        enlaceElement.appendChild(imgElement);

        var descripcionElement = document.createElement("div");
        descripcionElement.classList.add("descripcion");

        var tituloElement = document.createElement("p");
        tituloElement.classList.add("titulo");
        tituloElement.textContent = cancion.titulo;

        var introElement = document.createElement("p");
        introElement.classList.add("intro");
        introElement.innerHTML = limpiarLetra(cancion.letra); // Llamar a la función limpiarLetra

        var btnGroupElement = document.createElement("div");
        btnGroupElement.classList.add("btn-group");

        var buttonElement = document.createElement("button");
        buttonElement.type = "button";
        buttonElement.classList.add("btn", "btn-sm", "btn-outline-secondary");
        buttonElement.textContent = "Ver";
        buttonElement.setAttribute("onclick", 'cargarCanciones("' + cancion.id + '","N")');

        btnGroupElement.appendChild(buttonElement);

        descripcionElement.appendChild(tituloElement);
        descripcionElement.appendChild(introElement);
        descripcionElement.appendChild(btnGroupElement);

        cartaElement.appendChild(enlaceElement);
        cartaElement.appendChild(descripcionElement);

        mainElement.appendChild(cartaElement);
    });
}

// Función para limpiar la letra
function limpiarLetra(letra) {
    return letra.replace(/\([^()]*\)/g, ''); // Eliminar todo lo que está dentro de paréntesis
}

// Cargar el archivo JSON y crear las cartas
cargarJSON('canciones.json', function(response) {
    var canciones = JSON.parse(response).canciones;
    crearCartas(canciones);
});


function imprimirPagina() {
    window.print();
  }
  
  // Función para ocultar la clase "Rapida" y mostrar la clase "Lenta"
function mostrarLenta() {
    document.querySelectorAll('.Rapida').forEach(elemento => {
        elemento.style.display = 'none';
    });
    document.querySelectorAll('.Lenta').forEach(elemento => {
        elemento.style.display = 'block';
    });
}

// Función para ocultar la clase "Lenta" y mostrar la clase "Rapida"
function mostrarRapida() {
    document.querySelectorAll('.Lenta').forEach(elemento => {
        elemento.style.display = 'none';
    });
    document.querySelectorAll('.Rapida').forEach(elemento => {
        elemento.style.display = 'block';
    });
}

// Función para mostrar ambas clases
function mostrarAmbas() {
    document.querySelectorAll('.Rapida, .Lenta').forEach(elemento => {
        elemento.style.display = 'block';
    });
}









/*
function alternarEstilos() {
    const elementos = document.querySelectorAll('footer, #cancion p,titulo, #lis p,b, .btn_buscar, .btn_tipo, header, body, .carta, .cartas_container');
    
    elementos.forEach(elemento => {
        if (!elemento.classList.contains('estilos-alternos')) {
            elemento.classList.add('estilos-alternos');
        } else {
            elemento.classList.remove('estilos-alternos');
        }
    });
}*/
    </script>
</body>
</html>
